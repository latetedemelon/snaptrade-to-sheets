<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    label { font-weight: bold; font-size: 13px; }
    input { width: 100%; padding: 8px; margin: 6px 0 16px; border: 1px solid #ddd; border-radius: 4px; }
    .btn { background: #1a73e8; color: #fff; padding: 10px 16px; border: none; border-radius: 4px; cursor: pointer; }
    .btn:hover { opacity: 0.95; }
    #status { margin-top: 10px; font-size: 13px; }
  </style>
</head>
<body>
  <h3>Import Transactions</h3>
  <p>Select the date range to import. Leave blank to fetch recent activity.</p>
  <label for="start">Start Date</label>
  <input type="date" id="start">
  <label for="end">End Date</label>
  <input type="date" id="end">
  <button class="btn" id="import-btn">Refresh Transactions</button>
  <div id="status"></div>

  <script>
    document.getElementById('import-btn').addEventListener('click', function() {
      const start = document.getElementById('start').value;
      const end = document.getElementById('end').value;
      document.getElementById('status').textContent = 'Importing transactions...';
      google.script.run
        .withSuccessHandler(function() {
          document.getElementById('status').textContent = 'Transactions refreshed.';
        })
        .withFailureHandler(function(err) {
          document.getElementById('status').textContent = 'Error: ' + err.message;
        })
        .refreshTransactions(start, end);
    });
  </script>
</body>
</html>
